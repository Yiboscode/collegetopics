/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                     *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css               *//* empty css              */import{r as c}from"./request-CfAbx4ue.js";/* empty css                    */import{O as I,r as J,c as N,a as g,n as f,b as o,z as O,w as a,A as P,B as A,C as $,D as F,o as u,j as i,G,m as _,P as H,u as M,J as q,K,L,Q,R as W,N as V,E as m}from"./index-BlySnbrc.js";/* empty css              */const X={class:"card",style:{"margin-bottom":"5px"}},Y={class:"card",style:{"margin-bottom":"5px"}},Z={class:"card",style:{"margin-bottom":"5px"}},ee={key:0,class:"card"},te={class:"dialog-footer"},ke={__name:"Enroll",setup(oe){const y=I(),t=J({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:5,formVisible:!1,form:{},ids:[],projectName:null,content:""}),d=()=>{const r={pageNum:t.pageNum,pageSize:t.pageSize,projectName:t.projectName};t.user.role==="TEACHER"&&(r.teacherId=t.user.id),c.get("/enroll/selectPage",{params:r}).then(e=>{var p,s;t.tableData=((p=e.data)==null?void 0:p.list)||[],t.total=(s=e.data)==null?void 0:s.total})},E=r=>{t.form=JSON.parse(JSON.stringify(r)),t.formVisible=!0},C=()=>{c.put("/enroll/update",t.form).then(r=>{r.code==="200"?(t.formVisible=!1,m.success("操作成功"),d()):m.error(r.msg)})},v=r=>{V.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(e=>{c.delete("/enroll/delete/"+r).then(p=>{p.code==="200"?(m.success("删除成功"),d()):m.error(p.msg)})}).catch(e=>{console.error(e)})},x=r=>{t.ids=r.map(e=>e.id)},S=()=>{if(!t.ids.length){m.warning("请选择数据");return}V.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(r=>{c.delete("/enroll/delete/batch",{data:t.ids}).then(e=>{e.code==="200"?(m.success("操作成功"),d()):m.error(e.msg)})}).catch(r=>console.log(r))},B=()=>{y.value.validate(r=>{r&&C()})},h=()=>{t.projectName=null,d()};return d(),(r,e)=>{const p=O,s=P,n=G,b=H,j=A,z=$,w=W,R=Q,k=L,T=K,D=F;return u(),N("div",null,[g("div",X,[o(p,{modelValue:t.projectName,"onUpdate:modelValue":e[0]||(e[0]=l=>t.projectName=l),placeholder:"请输入项目名称查询",style:{width:"240px"}},null,8,["modelValue"]),o(s,{type:"info",plain:"",style:{"margin-left":"10px"},onClick:d},{default:a(()=>e[6]||(e[6]=[i("查询")])),_:1}),o(s,{type:"warning",plain:"",style:{"margin-left":"10px"},onClick:h},{default:a(()=>e[7]||(e[7]=[i("重置")])),_:1})]),g("div",Y,[o(s,{type:"danger",plain:"",onClick:S},{default:a(()=>e[8]||(e[8]=[i("批量删除")])),_:1})]),g("div",Z,[o(j,{data:t.tableData,stripe:"",onSelectionChange:x,"tooltip-effect":"dark dark1"},{default:a(()=>[o(n,{type:"selection",width:"55"}),o(n,{prop:"projectName",label:"项目名称","show-overflow-tooltip":""}),o(n,{prop:"userName",label:"用户"}),o(n,{prop:"teacherName",label:"指导教师"}),o(n,{prop:"name",label:"报名人"}),o(n,{prop:"content",label:"个人简介","show-overflow-tooltip":""}),o(n,{prop:"phone",label:"联系方式","show-overflow-tooltip":""}),o(n,{prop:"time",label:"报名时间","show-overflow-tooltip":""}),o(n,{prop:"status",label:"审核状态"},{default:a(l=>[l.row.status==="待审核"?(u(),_(b,{key:0,type:"warning"},{default:a(()=>e[9]||(e[9]=[i("待审核")])),_:1})):f("",!0),l.row.status==="审核通过"?(u(),_(b,{key:1,type:"success"},{default:a(()=>e[10]||(e[10]=[i("审核通过")])),_:1})):f("",!0),l.row.status==="审核未通过"?(u(),_(b,{key:2,type:"danger"},{default:a(()=>e[11]||(e[11]=[i("审核未通过")])),_:1})):f("",!0)]),_:1}),o(n,{prop:"reason",label:"审核原因","show-overflow-tooltip":""}),o(n,{label:"操作",width:"120",fixed:"right"},{default:a(l=>[t.user.role==="TEACHER"?(u(),_(s,{key:0,type:"primary",size:"small",onClick:U=>E(l.row),disabled:l.row.status==="审核通过"},{default:a(()=>e[12]||(e[12]=[i("审核")])),_:2},1032,["onClick","disabled"])):f("",!0),o(s,{type:"danger",circle:"",icon:M(q),onClick:U=>v(l.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),t.total?(u(),N("div",ee,[o(z,{onCurrentChange:d,background:"",layout:"total, prev, pager, next","page-size":t.pageSize,"current-page":t.pageNum,"onUpdate:currentPage":e[1]||(e[1]=l=>t.pageNum=l),total:t.total},null,8,["page-size","current-page","total"])])):f("",!0),o(D,{title:"审核",modelValue:t.formVisible,"onUpdate:modelValue":e[5]||(e[5]=l=>t.formVisible=l),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[g("span",te,[o(s,{onClick:e[4]||(e[4]=l=>t.formVisible=!1)},{default:a(()=>e[13]||(e[13]=[i("取消")])),_:1}),o(s,{type:"primary",onClick:B},{default:a(()=>e[14]||(e[14]=[i("保存")])),_:1})])]),default:a(()=>[o(T,{model:t.form,"label-width":"100px",style:{padding:"20px 30px"},ref_key:"formRef",ref:y},{default:a(()=>[o(k,{label:"审核状态",prop:"status"},{default:a(()=>[o(R,{modelValue:t.form.status,"onUpdate:modelValue":e[2]||(e[2]=l=>t.form.status=l)},{default:a(()=>[o(w,{label:"审核通过"}),o(w,{label:"审核未通过"})]),_:1},8,["modelValue"])]),_:1}),o(k,{label:"处理意见",prop:"reason"},{default:a(()=>[o(p,{type:"textarea",rows:3,modelValue:t.form.reason,"onUpdate:modelValue":e[3]||(e[3]=l=>t.form.reason=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{ke as default};
