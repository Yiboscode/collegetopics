/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                 *//* empty css                    *//* empty css              *//* empty css                  *//* empty css               *//* empty css            *//* empty css                   *//* empty css            *//* empty css               *//* empty css                     *//* empty css                *//* empty css                     */import{r as V}from"./request-CfAbx4ue.js";/* empty css                    */import{_ as X,O as Z,r as ee,c as d,a as i,n as S,b as l,z as te,w as r,S as le,A as oe,B as re,C as ae,D as ie,E as u,o as n,F as v,x as k,m as x,T as ne,j as s,G as se,P as de,t as y,H as pe,K as ue,a3 as me,a4 as fe,L as ce,U as ge,M as ye,u as _e,N as B}from"./index-BlySnbrc.js";const we={class:"card",style:{"margin-bottom":"5px"}},be={class:"card",style:{"margin-bottom":"5px"}},xe={class:"card",style:{"margin-bottom":"5px"}},Ve={key:1,style:{color:"#ccc"}},ve={key:0,class:"card"},ke={key:0,style:{"margin-top":"10px"}},Te={class:"dialog-footer"},Ue={key:0,style:{padding:"20px"}},Ce={style:{"margin-top":"10px",padding:"15px","background-color":"#f8f9fa","border-radius":"6px","line-height":"1.6"}},Ee={key:0,style:{"text-align":"center"}},he={key:1,style:{"text-align":"center",color:"#ccc",padding:"50px 0"}},Se={class:"dialog-footer"},ze={__name:"ExcellentTopic",setup(Ne){const D="/api",U=Z(),t=ee({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:10,title:"",category:"",year:null,formVisible:!1,viewVisible:!1,form:{},currentTopic:null,ids:[],categories:["科技创新","社会公益","文化创意","商业模式","环境保护","教育培训"],years:[],rules:{title:[{required:!0,message:"请输入选题名称",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}],year:[{required:!0,message:"请选择年份",trigger:"change"}],awardInfo:[{required:!0,message:"请输入获奖信息",trigger:"blur"}]}}),Y=()=>{const a=new Date().getFullYear();for(let e=a;e>=2010;e--)t.years.push(e)},m=()=>{const a={pageNum:t.pageNum,pageSize:t.pageSize,title:t.title,category:t.category,year:t.year};V.get("/excellentTopic/selectPage",{params:a}).then(e=>{var f,w;e.code==="200"?(t.tableData=((f=e.data)==null?void 0:f.list)||[],t.total=((w=e.data)==null?void 0:w.total)||0):u.error(e.msg||"查询失败")})},q=()=>{t.title="",t.category="",t.year=null,m()},F=()=>{t.form={},t.formVisible=!0},O=a=>{t.form=JSON.parse(JSON.stringify(a)),t.formVisible=!0},P=a=>{t.currentTopic=a,t.viewVisible=!0},$=a=>{t.form.imageUrl=a.data,u.success("图片上传成功")},J=()=>{U.value.validate(a=>{a&&V.post("/excellentTopic/add",t.form).then(e=>{e.code==="200"?(t.formVisible=!1,u.success("新增成功"),m()):u.error(e.msg)})})},M=()=>{V.put("/excellentTopic/update",t.form).then(a=>{a.code==="200"?(t.formVisible=!1,u.success("修改成功"),m()):u.error(a.msg)})},R=()=>{U.value.validate(a=>{a&&(t.form.id?M():J())})},A=a=>{B.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(()=>{V.delete("/excellentTopic/delete/"+a).then(e=>{e.code==="200"?(u.success("删除成功"),m()):u.error(e.msg)})}).catch(()=>{})},L=a=>{t.ids=a.map(e=>e.id)},j=()=>{if(!t.ids.length){u.warning("请选择数据");return}B.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(()=>{V.delete("/excellentTopic/delete/batch",{data:t.ids}).then(a=>{a.code==="200"?(u.success("操作成功"),m()):u.error(a.msg)})}).catch(()=>{})},z=a=>({科技创新:"primary",社会公益:"success",文化创意:"warning",商业模式:"danger",环境保护:"info",教育培训:""})[a]||"";return Y(),m(),(a,e)=>{const f=te,w=ne,C=le,p=oe,c=se,T=de,E=pe,G=re,H=ae,_=ce,b=fe,h=me,K=ge,Q=ye,W=ue,N=ie;return n(),d("div",null,[i("div",we,[l(f,{modelValue:t.title,"onUpdate:modelValue":e[0]||(e[0]=o=>t.title=o),placeholder:"请输入选题名称查询",style:{width:"240px"}},null,8,["modelValue"]),l(C,{modelValue:t.category,"onUpdate:modelValue":e[1]||(e[1]=o=>t.category=o),clearable:"",placeholder:"请选择分类",style:{width:"150px","margin-left":"10px"}},{default:r(()=>[(n(!0),d(v,null,k(t.categories,o=>(n(),x(w,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(C,{modelValue:t.year,"onUpdate:modelValue":e[2]||(e[2]=o=>t.year=o),clearable:"",placeholder:"请选择年份",style:{width:"120px","margin-left":"10px"}},{default:r(()=>[(n(!0),d(v,null,k(t.years,o=>(n(),x(w,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),l(p,{type:"info",plain:"",style:{"margin-left":"10px"},onClick:m},{default:r(()=>e[14]||(e[14]=[s("查询")])),_:1}),l(p,{type:"warning",plain:"",style:{"margin-left":"10px"},onClick:q},{default:r(()=>e[15]||(e[15]=[s("重置")])),_:1})]),i("div",be,[l(p,{type:"primary",plain:"",onClick:F},{default:r(()=>e[16]||(e[16]=[s("新增")])),_:1}),l(p,{type:"danger",plain:"",onClick:j},{default:r(()=>e[17]||(e[17]=[s("批量删除")])),_:1})]),i("div",xe,[l(G,{data:t.tableData,stripe:"",onSelectionChange:L,"tooltip-effect":"dark"},{default:r(()=>[l(c,{type:"selection",width:"55"}),l(c,{prop:"title",label:"选题名称","min-width":"200","show-overflow-tooltip":""}),l(c,{prop:"category",label:"分类",width:"120"},{default:r(o=>[l(T,{type:z(o.row.category)},{default:r(()=>[s(y(o.row.category),1)]),_:2},1032,["type"])]),_:1}),l(c,{label:"图片",width:"80"},{default:r(o=>[o.row.imageUrl?(n(),x(E,{key:0,style:{width:"40px",height:"40px","border-radius":"5px"},src:o.row.imageUrl,"preview-src-list":[o.row.imageUrl],"preview-teleported":"",fit:"cover"},null,8,["src","preview-src-list"])):(n(),d("span",Ve,"暂无图片"))]),_:1}),l(c,{prop:"awardInfo",label:"获奖信息","min-width":"150","show-overflow-tooltip":""}),l(c,{prop:"year",label:"年份",width:"100"}),l(c,{prop:"tags",label:"标签",width:"200","show-overflow-tooltip":""},{default:r(o=>{var g;return[(n(!0),d(v,null,k(((g=o.row.tags)==null?void 0:g.split(","))||[],I=>(n(),x(T,{key:I,size:"small",effect:"plain",style:{"margin-right":"5px","margin-bottom":"3px"}},{default:r(()=>[s(y(I.trim()),1)]),_:2},1024))),128))]}),_:1}),l(c,{label:"操作",width:"200",fixed:"right"},{default:r(o=>[l(p,{type:"primary",size:"small",onClick:g=>P(o.row)},{default:r(()=>e[18]||(e[18]=[s("查看")])),_:2},1032,["onClick"]),l(p,{type:"success",size:"small",onClick:g=>O(o.row)},{default:r(()=>e[19]||(e[19]=[s("编辑")])),_:2},1032,["onClick"]),l(p,{type:"danger",size:"small",onClick:g=>A(o.row.id)},{default:r(()=>e[20]||(e[20]=[s("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])]),t.total?(n(),d("div",ve,[l(H,{onCurrentChange:m,background:"",layout:"total, prev, pager, next","page-size":t.pageSize,"current-page":t.pageNum,"onUpdate:currentPage":e[3]||(e[3]=o=>t.pageNum=o),total:t.total},null,8,["page-size","current-page","total"])])):S("",!0),l(N,{title:t.form.id?"编辑优秀选题":"新增优秀选题",modelValue:t.formVisible,"onUpdate:modelValue":e[11]||(e[11]=o=>t.formVisible=o),width:"60%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[i("span",Te,[l(p,{onClick:e[10]||(e[10]=o=>t.formVisible=!1)},{default:r(()=>e[24]||(e[24]=[s("取消")])),_:1}),l(p,{type:"primary",onClick:R},{default:r(()=>e[25]||(e[25]=[s("保存")])),_:1})])]),default:r(()=>[l(W,{model:t.form,rules:t.rules,"label-width":"100px",style:{padding:"20px 30px"},ref_key:"formRef",ref:U},{default:r(()=>[l(h,{gutter:20},{default:r(()=>[l(b,{span:12},{default:r(()=>[l(_,{label:"选题名称",prop:"title"},{default:r(()=>[l(f,{modelValue:t.form.title,"onUpdate:modelValue":e[4]||(e[4]=o=>t.form.title=o),placeholder:"请输入选题名称"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{span:12},{default:r(()=>[l(_,{label:"选题分类",prop:"category"},{default:r(()=>[l(C,{modelValue:t.form.category,"onUpdate:modelValue":e[5]||(e[5]=o=>t.form.category=o),placeholder:"请选择分类",style:{width:"100%"}},{default:r(()=>[(n(!0),d(v,null,k(t.categories,o=>(n(),x(w,{key:o,label:o,value:o},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(h,{gutter:20},{default:r(()=>[l(b,{span:12},{default:r(()=>[l(_,{label:"年份",prop:"year"},{default:r(()=>[l(K,{modelValue:t.form.year,"onUpdate:modelValue":e[6]||(e[6]=o=>t.form.year=o),type:"year",placeholder:"请选择年份",style:{width:"100%"},"value-format":"YYYY"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{span:12},{default:r(()=>[l(_,{label:"获奖信息",prop:"awardInfo"},{default:r(()=>[l(f,{modelValue:t.form.awardInfo,"onUpdate:modelValue":e[7]||(e[7]=o=>t.form.awardInfo=o),placeholder:"请输入获奖信息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(_,{label:"图片",prop:"imageUrl"},{default:r(()=>[l(Q,{action:_e(D)+"/files/upload",headers:{token:t.user.token},"list-type":"picture","on-success":$},{default:r(()=>[l(p,{type:"primary"},{default:r(()=>e[21]||(e[21]=[s("上传图片")])),_:1})]),_:1},8,["action","headers"]),t.form.imageUrl?(n(),d("div",ke,[e[22]||(e[22]=i("div",{style:{"margin-bottom":"5px",color:"#666"}},"当前图片：",-1)),l(E,{src:t.form.imageUrl,style:{width:"100px",height:"100px","border-radius":"5px"},fit:"cover"},null,8,["src"])])):S("",!0)]),_:1}),l(_,{label:"选题描述",prop:"description"},{default:r(()=>[l(f,{modelValue:t.form.description,"onUpdate:modelValue":e[8]||(e[8]=o=>t.form.description=o),type:"textarea",rows:4,placeholder:"请输入选题描述"},null,8,["modelValue"])]),_:1}),l(_,{label:"标签",prop:"tags"},{default:r(()=>[l(f,{modelValue:t.form.tags,"onUpdate:modelValue":e[9]||(e[9]=o=>t.form.tags=o),placeholder:"请输入标签，多个标签用逗号分隔"},null,8,["modelValue"]),e[23]||(e[23]=i("div",{style:{"margin-top":"8px",color:"#999","font-size":"12px"}}," 例如：人工智能,大数据,机器学习 ",-1))]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"]),l(N,{title:"优秀选题详情",modelValue:t.viewVisible,"onUpdate:modelValue":e[13]||(e[13]=o=>t.viewVisible=o),width:"70%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[i("span",Se,[l(p,{onClick:e[12]||(e[12]=o=>t.viewVisible=!1)},{default:r(()=>e[31]||(e[31]=[s("关闭")])),_:1})])]),default:r(()=>[t.currentTopic?(n(),d("div",Ue,[l(h,{gutter:20},{default:r(()=>[l(b,{span:16},{default:r(()=>{var o;return[i("h3",null,y(t.currentTopic.title),1),i("p",null,[e[26]||(e[26]=i("strong",null,"分类：",-1)),l(T,{type:z(t.currentTopic.category)},{default:r(()=>[s(y(t.currentTopic.category),1)]),_:1},8,["type"])]),i("p",null,[e[27]||(e[27]=i("strong",null,"年份：",-1)),s(y(t.currentTopic.year),1)]),i("p",null,[e[28]||(e[28]=i("strong",null,"获奖信息：",-1)),s(y(t.currentTopic.awardInfo),1)]),i("p",null,[e[29]||(e[29]=i("strong",null,"标签：",-1)),(n(!0),d(v,null,k(((o=t.currentTopic.tags)==null?void 0:o.split(","))||[],g=>(n(),x(T,{key:g,size:"small",effect:"plain",style:{"margin-right":"5px"}},{default:r(()=>[s(y(g.trim()),1)]),_:2},1024))),128))]),e[30]||(e[30]=i("div",null,[i("strong",null,"选题描述：")],-1)),i("div",Ce,y(t.currentTopic.description),1)]}),_:1}),l(b,{span:8},{default:r(()=>[t.currentTopic.imageUrl?(n(),d("div",Ee,[l(E,{src:t.currentTopic.imageUrl,style:{width:"100%","max-width":"300px","border-radius":"8px"},"preview-src-list":[t.currentTopic.imageUrl],"preview-teleported":"",fit:"cover"},null,8,["src","preview-src-list"])])):(n(),d("div",he," 暂无图片 "))]),_:1})]),_:1})])):S("",!0)]),_:1},8,["modelValue"])])}}},Xe=X(ze,[["__scopeId","data-v-0b9fb4cc"]]);export{Xe as default};
