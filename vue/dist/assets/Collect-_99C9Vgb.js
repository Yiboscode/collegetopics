/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                    *//* empty css              *//* empty css                  *//* empty css               *//* empty css            *//* empty css               *//* empty css                   *//* empty css                     *//* empty css                */import{r as m}from"./request-CfAbx4ue.js";/* empty css                    */import{O as q,r as A,c as f,a as g,n as F,b as o,z as H,w as r,A as J,B as T,C as $,D as R,E as s,o as p,j as u,G,u as k,I as K,J as Q,K as W,L as X,S as Z,F as C,x as v,m as x,T as ee,U as te,N as w}from"./index-BlySnbrc.js";const le={class:"card",style:{"margin-bottom":"5px"}},oe={class:"card",style:{"margin-bottom":"5px"}},ae={class:"card",style:{"margin-bottom":"5px"}},re={key:0,class:"card"},se={class:"dialog-footer"},Ie={__name:"Collect",setup(ne){const b=q(),e=A({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:5,formVisible:!1,form:{},ids:[],name:null,rules:{projectId:[{required:!0,message:"请输入项目ID%name%name|项目名称",trigger:"blur"}],userId:[{required:!0,message:"请输入用户ID%name%name|用户名称",trigger:"blur"}],time:[{required:!0,message:"请输入时间",trigger:"blur"}]},projectList:[],userList:[]});(()=>{m.get("/project/selectAll").then(l=>{l.code==="200"?e.projectList=l.data:s.error(l.msg)})})(),(()=>{m.get("/user/selectAll").then(l=>{l.code==="200"?e.userList=l.data:s.error(l.msg)})})();const n=()=>{m.get("/collect/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,name:e.name}}).then(l=>{var t,d;e.tableData=((t=l.data)==null?void 0:t.list)||[],e.total=(d=l.data)==null?void 0:d.total})},E=()=>{e.form={},e.formVisible=!0},I=l=>{e.form=JSON.parse(JSON.stringify(l)),e.formVisible=!0},N=()=>{m.post("/collect/add",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("操作成功"),n()):s.error(l.msg)})},D=()=>{m.put("/collect/update",e.form).then(l=>{l.code==="200"?(e.formVisible=!1,s.success("操作成功"),n()):s.error(l.msg)})},h=l=>{w.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(t=>{m.delete("/collect/delete/"+l).then(d=>{d.code==="200"?(s.success("删除成功"),n()):s.error(d.msg)})}).catch(t=>{console.error(t)})},j=l=>{e.ids=l.map(t=>t.id)},S=()=>{if(!e.ids.length){s.warning("请选择数据");return}w.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(l=>{m.delete("/collect/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("操作成功"),n()):s.error(t.msg)})}).catch(l=>console.log(l))},U=()=>{b.value.validate(l=>{l&&(e.form.id?D():N())})},B=()=>{e.name=null,n()};return n(),(l,t)=>{const d=H,i=J,c=G,L=T,Y=$,y=ee,V=Z,_=X,z=te,M=W,P=R;return p(),f("div",null,[g("div",le,[o(d,{modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=a=>e.name=a),placeholder:"请输入关键字查询",style:{width:"240px"}},null,8,["modelValue"]),o(i,{type:"info",plain:"",style:{"margin-left":"10px"},onClick:n},{default:r(()=>t[7]||(t[7]=[u("查询")])),_:1}),o(i,{type:"warning",plain:"",style:{"margin-left":"10px"},onClick:B},{default:r(()=>t[8]||(t[8]=[u("重置")])),_:1})]),g("div",oe,[o(i,{type:"primary",plain:"",onClick:E},{default:r(()=>t[9]||(t[9]=[u("新增")])),_:1}),o(i,{type:"danger",plain:"",onClick:S},{default:r(()=>t[10]||(t[10]=[u("批量删除")])),_:1})]),g("div",ae,[o(L,{data:e.tableData,stripe:"",onSelectionChange:j},{default:r(()=>[o(c,{type:"selection",width:"55"}),o(c,{prop:"projectName",label:"项目名称"}),o(c,{prop:"userName",label:"用户名称"}),o(c,{prop:"time",label:"时间"}),o(c,{label:"操作",width:"100",fixed:"right"},{default:r(a=>[o(i,{type:"primary",circle:"",icon:k(K),onClick:O=>I(a.row)},null,8,["icon","onClick"]),o(i,{type:"danger",circle:"",icon:k(Q),onClick:O=>h(a.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(p(),f("div",re,[o(Y,{onCurrentChange:n,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):F("",!0),o(P,{title:"收藏信息",modelValue:e.formVisible,"onUpdate:modelValue":t[6]||(t[6]=a=>e.formVisible=a),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[g("span",se,[o(i,{onClick:t[5]||(t[5]=a=>e.formVisible=!1)},{default:r(()=>t[11]||(t[11]=[u("取消")])),_:1}),o(i,{type:"primary",onClick:U},{default:r(()=>t[12]||(t[12]=[u("保存")])),_:1})])]),default:r(()=>[o(M,{model:e.form,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px"},ref_key:"formRef",ref:b},{default:r(()=>[o(_,{label:"项目ID",prop:"projectId"},{default:r(()=>[o(V,{style:{width:"100%"},modelValue:e.form.projectId,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.projectId=a)},{default:r(()=>[(p(!0),f(C,null,v(e.projectList,a=>(p(),x(y,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{label:"用户ID",prop:"userId"},{default:r(()=>[o(V,{style:{width:"100%"},modelValue:e.form.userId,"onUpdate:modelValue":t[3]||(t[3]=a=>e.form.userId=a)},{default:r(()=>[(p(!0),f(C,null,v(e.userList,a=>(p(),x(y,{key:a.id,value:a.id,label:a.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(_,{label:"时间",prop:"time"},{default:r(()=>[o(z,{placeholder:"请选择日期时间",type:"datetime",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",modelValue:e.form.time,"onUpdate:modelValue":t[4]||(t[4]=a=>e.form.time=a),style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{Ie as default};
