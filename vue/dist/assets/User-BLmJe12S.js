/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                 *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as f}from"./request-CfAbx4ue.js";/* empty css                    */import{r as T,c as b,a as c,n as V,b as o,z as $,w as r,A,B as O,C as j,D as q,o as g,j as m,G,m as H,H as K,u as _,I as L,J as Q,K as R,L as W,M as X,N as y,E as d}from"./index-BlySnbrc.js";const Y={class:"card",style:{"margin-bottom":"5px"}},Z={class:"card",style:{"margin-bottom":"5px"}},ee={class:"card",style:{"margin-bottom":"5px"}},le={key:0,class:"card"},oe={class:"dialog-footer"},xe={__name:"User",setup(te){const v="/api",l=T({formVisible:!1,form:{},tableData:[],pageNum:1,pageSize:10,total:0,name:null,ids:[]}),i=()=>{f.get("/user/selectPage",{params:{pageNum:l.pageNum,pageSize:l.pageSize,name:l.name}}).then(a=>{var e,n;a.code==="200"&&(l.tableData=((e=a.data)==null?void 0:e.list)||[],l.total=(n=a.data)==null?void 0:n.total)})},w=()=>{l.form={},l.formVisible=!0},x=a=>{l.form=JSON.parse(JSON.stringify(a)),l.formVisible=!0},C=()=>{f.post("/user/add",l.form).then(a=>{a.code==="200"?(d.success("操作成功"),l.formVisible=!1,i()):d.error(a.msg)})},k=()=>{f.put("/user/update",l.form).then(a=>{a.code==="200"&&(d.success("操作成功"),l.formVisible=!1,i())})},h=()=>{l.form.id?k():C()},E=a=>{y.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(e=>{f.delete("/user/delete/"+a).then(n=>{n.code==="200"?(d.success("删除成功"),i()):d.error(n.msg)})}).catch(e=>{console.error(e)})},N=()=>{if(!l.ids.length){d.warning("请选择数据");return}y.confirm("删除后数据无法恢复，您确定删除吗？","删除确认",{type:"warning"}).then(a=>{f.delete("/user/delete/batch",{data:l.ids}).then(e=>{e.code==="200"?(d.success("操作成功"),i()):d.error(e.msg)})}).catch(a=>{console.error(a)})},U=a=>{l.ids=a.map(e=>e.id)},S=a=>{l.form.avatar=a.data},B=()=>{l.name=null,i()};return i(),(a,e)=>{const n=$,s=A,p=G,z=K,D=O,I=j,u=W,F=X,J=R,M=q;return g(),b("div",null,[c("div",Y,[o(n,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=t=>l.name=t),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入名称查询"},null,8,["modelValue"]),o(s,{type:"info",plain:"",onClick:i},{default:r(()=>e[8]||(e[8]=[m("查询")])),_:1}),o(s,{type:"warning",plain:"",style:{margin:"0 10px"},onClick:B},{default:r(()=>e[9]||(e[9]=[m("重置")])),_:1})]),c("div",Z,[o(s,{type:"primary",plain:"",onClick:w},{default:r(()=>e[10]||(e[10]=[m("新增")])),_:1}),o(s,{type:"danger",plain:"",onClick:N},{default:r(()=>e[11]||(e[11]=[m("批量删除")])),_:1})]),c("div",ee,[o(D,{stripe:"",data:l.tableData,onSelectionChange:U},{default:r(()=>[o(p,{type:"selection",width:"55"}),o(p,{prop:"username",label:"账号"}),o(p,{prop:"avatar",label:"头像"},{default:r(t=>[t.row.avatar?(g(),H(z,{key:0,style:{width:"40px",height:"40px","border-radius":"50%",display:"block"},src:t.row.avatar,"preview-src-list":[t.row.avatar],"preview-teleported":""},null,8,["src","preview-src-list"])):V("",!0)]),_:1}),o(p,{prop:"name",label:"姓名"}),o(p,{prop:"role",label:"角色"}),o(p,{prop:"phone",label:"电话"}),o(p,{prop:"email",label:"邮箱"}),o(p,{label:"操作",width:"100",fixed:"right"},{default:r(t=>[o(s,{type:"primary",circle:"",icon:_(L),onClick:P=>x(t.row)},null,8,["icon","onClick"]),o(s,{type:"danger",circle:"",icon:_(Q),onClick:P=>E(t.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),l.total?(g(),b("div",le,[o(I,{onCurrentChange:i,background:"",layout:"prev, pager, next","page-size":l.pageSize,"current-page":l.pageNum,"onUpdate:currentPage":e[1]||(e[1]=t=>l.pageNum=t),total:l.total},null,8,["page-size","current-page","total"])])):V("",!0),o(M,{title:"用户信息",modelValue:l.formVisible,"onUpdate:modelValue":e[7]||(e[7]=t=>l.formVisible=t),width:"40%","destroy-on-close":""},{footer:r(()=>[c("span",oe,[o(s,{onClick:e[6]||(e[6]=t=>l.formVisible=!1)},{default:r(()=>e[13]||(e[13]=[m("取 消")])),_:1}),o(s,{type:"primary",onClick:h},{default:r(()=>e[14]||(e[14]=[m("确 定")])),_:1})])]),default:r(()=>[o(J,{ref:"form",model:l.form,"label-width":"70px",style:{padding:"20px"}},{default:r(()=>[o(u,{prop:"username",label:"用户名"},{default:r(()=>[o(n,{modelValue:l.form.username,"onUpdate:modelValue":e[2]||(e[2]=t=>l.form.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),o(u,{prop:"avatar",label:"头像"},{default:r(()=>[o(F,{action:_(v)+"/files/upload","on-success":S,"list-type":"picture"},{default:r(()=>[o(s,{type:"primary"},{default:r(()=>e[12]||(e[12]=[m("点击上传")])),_:1})]),_:1},8,["action"])]),_:1}),o(u,{prop:"name",label:"姓名"},{default:r(()=>[o(n,{modelValue:l.form.name,"onUpdate:modelValue":e[3]||(e[3]=t=>l.form.name=t),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1}),o(u,{prop:"phone",label:"电话"},{default:r(()=>[o(n,{modelValue:l.form.phone,"onUpdate:modelValue":e[4]||(e[4]=t=>l.form.phone=t),placeholder:"请输入电话"},null,8,["modelValue"])]),_:1}),o(u,{prop:"email",label:"邮箱"},{default:r(()=>[o(n,{modelValue:l.form.email,"onUpdate:modelValue":e[5]||(e[5]=t=>l.form.email=t),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{xe as default};
