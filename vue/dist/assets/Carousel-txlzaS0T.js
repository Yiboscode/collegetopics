/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                 *//* empty css            *//* empty css               *//* empty css                  *//* empty css                   *//* empty css                     *//* empty css                *//* empty css                     *//* empty css               *//* empty css              */import{r as m}from"./request-CfAbx4ue.js";/* empty css                    */import{O as A,r as M,c as g,a as f,n as k,b as l,z as $,w as r,A as R,B as G,C as H,D as K,E as s,o as c,j as p,G as Q,m as w,H as W,u as _,I as X,J as Y,K as Z,L as ee,S as te,F as oe,x as le,T as ae,M as re,N as x}from"./index-BlySnbrc.js";const se={class:"card",style:{"margin-bottom":"5px"}},ie={class:"card",style:{"margin-bottom":"5px"}},ne={class:"card",style:{"margin-bottom":"5px"}},de={key:0,class:"card"},pe={class:"dialog-footer"},Te={__name:"Carousel",setup(me){const V="/api",b=A(),e=M({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:5,formVisible:!1,form:{},ids:[],projectTitle:null,rules:{projectId:[{required:!0,message:"请输入项目ID%title%title|项目标题",trigger:"blur"}],img:[{required:!0,message:"请输入图片",trigger:"blur"}]},projectList:[]}),C=o=>{e.form.img=o.data};(()=>{m.get("/project/selectAll").then(o=>{o.code==="200"?e.projectList=o.data:s.error(o.msg)})})();const n=()=>{m.get("/carousel/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,projectTitle:e.projectTitle}}).then(o=>{var t,d;e.tableData=((t=o.data)==null?void 0:t.list)||[],e.total=(d=o.data)==null?void 0:d.total})},j=()=>{e.form={},e.formVisible=!0},v=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0},E=()=>{m.post("/carousel/add",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,s.success("操作成功"),n()):s.error(o.msg)})},h=()=>{m.put("/carousel/update",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,s.success("操作成功"),n()):s.error(o.msg)})},N=o=>{x.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(t=>{m.delete("/carousel/delete/"+o).then(d=>{d.code==="200"?(s.success("删除成功"),n()):s.error(d.msg)})}).catch(t=>{console.error(t)})},S=o=>{e.ids=o.map(t=>t.id)},I=()=>{if(!e.ids.length){s.warning("请选择数据");return}x.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(o=>{m.delete("/carousel/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("操作成功"),n()):s.error(t.msg)})}).catch(o=>console.log(o))},T=()=>{b.value.validate(o=>{o&&(e.form.id?h():E())})},B=()=>{e.projectTitle=null,n()};return n(),(o,t)=>{const d=$,i=R,u=Q,z=W,D=G,U=H,L=ae,O=te,y=ee,P=re,F=Z,J=K;return c(),g("div",null,[f("div",se,[l(d,{modelValue:e.projectTitle,"onUpdate:modelValue":t[0]||(t[0]=a=>e.projectTitle=a),placeholder:"请输入项目名称查询",style:{width:"240px"}},null,8,["modelValue"]),l(i,{type:"info",plain:"",style:{"margin-left":"10px"},onClick:n},{default:r(()=>t[5]||(t[5]=[p("查询")])),_:1}),l(i,{type:"warning",plain:"",style:{"margin-left":"10px"},onClick:B},{default:r(()=>t[6]||(t[6]=[p("重置")])),_:1})]),f("div",ie,[l(i,{type:"primary",plain:"",onClick:j},{default:r(()=>t[7]||(t[7]=[p("新增")])),_:1}),l(i,{type:"danger",plain:"",onClick:I},{default:r(()=>t[8]||(t[8]=[p("批量删除")])),_:1})]),f("div",ne,[l(D,{data:e.tableData,stripe:"",onSelectionChange:S},{default:r(()=>[l(u,{type:"selection",width:"55"}),l(u,{prop:"projectTitle",label:"项目标题"}),l(u,{label:"图片"},{default:r(a=>[a.row.img?(c(),w(z,{key:0,style:{width:"100px",height:"40px","border-radius":"5px"},src:a.row.img,"preview-src-list":[a.row.img],"preview-teleported":""},null,8,["src","preview-src-list"])):k("",!0)]),_:1}),l(u,{label:"操作",width:"100",fixed:"right"},{default:r(a=>[l(i,{type:"primary",circle:"",icon:_(X),onClick:q=>v(a.row)},null,8,["icon","onClick"]),l(i,{type:"danger",circle:"",icon:_(Y),onClick:q=>N(a.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(c(),g("div",de,[l(U,{onCurrentChange:n,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=a=>e.pageNum=a),total:e.total},null,8,["page-size","current-page","total"])])):k("",!0),l(J,{title:"轮播图信息",modelValue:e.formVisible,"onUpdate:modelValue":t[4]||(t[4]=a=>e.formVisible=a),width:"40%","close-on-click-modal":!1,"destroy-on-close":""},{footer:r(()=>[f("span",pe,[l(i,{onClick:t[3]||(t[3]=a=>e.formVisible=!1)},{default:r(()=>t[10]||(t[10]=[p("取消")])),_:1}),l(i,{type:"primary",onClick:T},{default:r(()=>t[11]||(t[11]=[p("保存")])),_:1})])]),default:r(()=>[l(F,{model:e.form,rules:e.rules,"label-width":"80px",style:{padding:"20px 30px"},ref_key:"formRef",ref:b},{default:r(()=>[l(y,{label:"项目",prop:"projectId"},{default:r(()=>[l(O,{style:{width:"100%"},modelValue:e.form.projectId,"onUpdate:modelValue":t[2]||(t[2]=a=>e.form.projectId=a)},{default:r(()=>[(c(!0),g(oe,null,le(e.projectList,a=>(c(),w(L,{key:a.id,value:a.id,label:a.title},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(y,{label:"图片",prop:"img"},{default:r(()=>[l(P,{action:_(V)+"/files/upload",headers:{token:e.user.token},"list-type":"picture","on-success":C},{default:r(()=>[l(i,{type:"primary"},{default:r(()=>t[9]||(t[9]=[p("上传")])),_:1})]),_:1},8,["action","headers"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue"])])}}};export{Te as default};
