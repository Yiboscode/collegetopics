/* empty css                *//* empty css                          *//* empty css               *//* empty css                *//* empty css                  *//* empty css               *//* empty css                 *//* empty css            *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css                     *//* empty css               *//* empty css              *//* empty css                    */import{r as S}from"./request-CfAbx4ue.js";import{_ as de,r as L,O as y,X as ue,c as h,a as p,b as e,z as pe,w as l,S as me,A as ce,B as ge,C as fe,D as ve,o as w,F as A,x as G,T as ye,j as r,G as _e,m as H,H as be,P as we,t as m,K as Ve,a3 as he,a4 as xe,L as ke,n as R,M as Ue,a5 as Ce,a6 as Ee,N as K,E as f}from"./index-BlySnbrc.js";const ze={class:"card",style:{"margin-bottom":"20px"}},Se={class:"card"},Te={style:{"margin-bottom":"20px"}},je={key:1,style:{color:"#999","font-size":"12px"}},Re={style:{"margin-top":"20px","text-align":"center"}},Be={key:0,style:{"margin-top":"10px"}},De={class:"dialog-footer"},Ie={key:0},Ne={style:{"text-align":"center"}},$e={style:{"margin-top":"20px"}},Fe={style:{"white-space":"pre-wrap","line-height":"1.6"}},Me={style:{"white-space":"pre-wrap","line-height":"1.6"}},Pe={style:{"white-space":"pre-wrap","line-height":"1.6"}},Oe={style:{"white-space":"pre-wrap","line-height":"1.6"}},qe={style:{"white-space":"pre-wrap","line-height":"1.6"}},Le={class:"dialog-footer"},Ae={__name:"Topic",setup(Ge){const i=L({title:"",category:"",status:""}),B=y([]),D=y(0),x=y(1),T=y(10),k=y([]),V=y(!1),U=y(!1),d=y(null),o=L({id:null,title:"",category:"",keywords:"",description:"",background:"",objectives:"",methodology:"",expectedResults:"",imageUrl:"",status:"待评价"}),I=y(),N=["科技创新","社会实践","文化创意","环境保护","商业模式","公益服务"],W={title:[{required:!0,message:"请输入选题名称",trigger:"blur"}],category:[{required:!0,message:"请选择分类",trigger:"change"}]};ue(()=>{_()});const _=()=>{const s={pageNum:x.value,pageSize:T.value};i.title&&i.title.trim()!==""&&(s.title=i.title.trim()),i.category&&i.category.trim()!==""&&(s.category=i.category.trim()),i.status&&i.status.trim()!==""&&(s.status=i.status.trim()),S.get("/topic/selectPage",{params:s}).then(t=>{var u,n;t.code==="200"&&(B.value=((u=t.data)==null?void 0:u.list)||[],D.value=((n=t.data)==null?void 0:n.total)||0)}).catch(t=>{console.error("加载数据失败:",t)})},X=()=>{i.title="",i.category="",i.status="",x.value=1,_()},J=()=>{$(),V.value=!0},Q=s=>{Object.assign(o,s),V.value=!0},Y=s=>{d.value=s,U.value=!0},Z=()=>{I.value.validate(s=>{if(s){const t=o.id?"/topic/update":"/topic/add",u=o.id?"put":"post";S[u](t,o).then(n=>{n.code==="200"?(f.success("操作成功"),V.value=!1,_()):f.error(n.msg||"操作失败")})}})},ee=s=>{K.confirm("您确认删除吗？","确认删除",{type:"warning"}).then(()=>{S.delete("/topic/delete/"+s).then(t=>{t.code==="200"?(f.success("删除成功"),_()):f.error(t.msg||"删除失败")})}).catch(()=>{})},te=s=>{k.value=s.map(t=>t.id)},le=()=>{if(!k.value.length){f.warning("请选择数据");return}K.confirm("您确认批量删除这些数据吗？","确认删除",{type:"warning"}).then(()=>{S.delete("/topic/del/batch",{data:k.value}).then(s=>{s.code==="200"?(f.success("删除成功"),_()):f.error(s.msg||"删除失败")})}).catch(()=>{})},$=()=>{Object.assign(o,{id:null,title:"",category:"",keywords:"",description:"",background:"",objectives:"",methodology:"",expectedResults:"",imageUrl:"",status:"待评价"})},F=s=>({待评价:"warning",评价中:"primary",审核中:"info",审核通过:"success",审核不通过:"danger"})[s]||"info",ae=s=>{const t=s.type.startsWith("image/"),u=s.size/1024/1024<10;return t?u?!0:(f.error("图片大小不能超过 10MB!"),!1):(f.error("只能上传图片文件!"),!1)},oe=s=>{s.code==="200"?(o.imageUrl=s.data,f.success("图片上传成功")):f.error("图片上传失败")};return(s,t)=>{const u=pe,n=ye,C=me,c=ce,b=_e,j=be,E=we,se=ge,re=fe,v=ke,z=xe,M=he,ie=Ue,ne=Ve,P=ve,g=Ee,O=Ce;return w(),h("div",null,[p("div",ze,[e(u,{modelValue:i.title,"onUpdate:modelValue":t[0]||(t[0]=a=>i.title=a),"prefix-icon":"Search",style:{width:"240px","margin-right":"10px"},placeholder:"请输入选题名称查询"},null,8,["modelValue"]),e(C,{modelValue:i.category,"onUpdate:modelValue":t[1]||(t[1]=a=>i.category=a),placeholder:"请选择分类",style:{width:"150px","margin-right":"10px"},clearable:""},{default:l(()=>[(w(),h(A,null,G(N,a=>e(n,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e(C,{modelValue:i.status,"onUpdate:modelValue":t[2]||(t[2]=a=>i.status=a),placeholder:"请选择状态",style:{width:"150px","margin-right":"10px"},clearable:""},{default:l(()=>[e(n,{label:"待评价",value:"待评价"}),e(n,{label:"评价中",value:"评价中"}),e(n,{label:"审核中",value:"审核中"}),e(n,{label:"审核通过",value:"审核通过"}),e(n,{label:"审核不通过",value:"审核不通过"})]),_:1},8,["modelValue"]),e(c,{type:"primary",onClick:_},{default:l(()=>t[19]||(t[19]=[r("查询")])),_:1}),e(c,{style:{"margin-left":"10px"},onClick:X},{default:l(()=>t[20]||(t[20]=[r("重置")])),_:1})]),p("div",Se,[p("div",Te,[e(c,{type:"primary",onClick:J},{default:l(()=>t[21]||(t[21]=[r("新增")])),_:1}),e(c,{type:"danger",onClick:le,disabled:!k.value.length},{default:l(()=>t[22]||(t[22]=[r("批量删除")])),_:1},8,["disabled"])]),e(se,{data:B.value,onSelectionChange:te,"row-key":"id"},{default:l(()=>[e(b,{type:"selection",width:"55",align:"center"}),e(b,{prop:"id",label:"ID",width:"80"}),e(b,{label:"图片",width:"100"},{default:l(a=>[a.row.imageUrl?(w(),H(j,{key:0,src:a.row.imageUrl,style:{width:"60px",height:"40px","border-radius":"5px"},fit:"cover","preview-src-list":[a.row.imageUrl]},null,8,["src","preview-src-list"])):(w(),h("span",je,"暂无图片"))]),_:1}),e(b,{prop:"title",label:"选题名称","min-width":"200","show-overflow-tooltip":""}),e(b,{prop:"category",label:"分类",width:"120"},{default:l(a=>[e(E,null,{default:l(()=>[r(m(a.row.category),1)]),_:2},1024)]),_:1}),e(b,{prop:"status",label:"状态",width:"100"},{default:l(a=>[e(E,{type:F(a.row.status)},{default:l(()=>[r(m(a.row.status),1)]),_:2},1032,["type"])]),_:1}),e(b,{prop:"submitTime",label:"提交时间",width:"180"}),e(b,{label:"操作",width:"320",align:"center",fixed:"right"},{default:l(a=>[e(c,{type:"primary",onClick:q=>Y(a.row),size:"small"},{default:l(()=>t[23]||(t[23]=[r("查看")])),_:2},1032,["onClick"]),e(c,{type:"success",onClick:q=>Q(a.row),size:"small"},{default:l(()=>t[24]||(t[24]=[r("编辑")])),_:2},1032,["onClick"]),e(c,{type:"danger",onClick:q=>ee(a.row.id),size:"small"},{default:l(()=>t[25]||(t[25]=[r("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),p("div",Re,[e(re,{"current-page":x.value,"onUpdate:currentPage":t[3]||(t[3]=a=>x.value=a),"page-size":T.value,"onUpdate:pageSize":t[4]||(t[4]=a=>T.value=a),"page-sizes":[10,20,30,50],layout:"total, sizes, prev, pager, next, jumper",total:D.value,onSizeChange:_,onCurrentChange:_},null,8,["current-page","page-size","total"])])]),e(P,{modelValue:V.value,"onUpdate:modelValue":t[16]||(t[16]=a=>V.value=a),title:o.id?"编辑选题":"新增选题",width:"70%",onClose:$},{footer:l(()=>[p("span",De,[e(c,{onClick:t[15]||(t[15]=a=>V.value=!1)},{default:l(()=>t[28]||(t[28]=[r("取消")])),_:1}),e(c,{type:"primary",onClick:Z},{default:l(()=>t[29]||(t[29]=[r("确定")])),_:1})])]),default:l(()=>[e(ne,{model:o,rules:W,ref_key:"formRef",ref:I,"label-width":"120px"},{default:l(()=>[e(M,{gutter:20},{default:l(()=>[e(z,{span:12},{default:l(()=>[e(v,{label:"选题名称",prop:"title"},{default:l(()=>[e(u,{modelValue:o.title,"onUpdate:modelValue":t[5]||(t[5]=a=>o.title=a),placeholder:"请输入选题名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(z,{span:12},{default:l(()=>[e(v,{label:"选题分类",prop:"category"},{default:l(()=>[e(C,{modelValue:o.category,"onUpdate:modelValue":t[6]||(t[6]=a=>o.category=a),placeholder:"请选择分类",style:{width:"100%"}},{default:l(()=>[(w(),h(A,null,G(N,a=>e(n,{key:a,label:a,value:a},null,8,["label","value"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(v,{label:"选题图片"},{default:l(()=>[e(ie,{action:s.$baseUrl+"/files/upload","before-upload":ae,"on-success":oe,"show-file-list":!1,style:{display:"inline-block"}},{default:l(()=>[e(c,{type:"primary"},{default:l(()=>t[26]||(t[26]=[r("点击上传")])),_:1})]),_:1},8,["action"]),o.imageUrl?(w(),h("div",Be,[e(j,{src:o.imageUrl,style:{width:"100px",height:"100px","border-radius":"5px"},fit:"cover","preview-src-list":[o.imageUrl]},null,8,["src","preview-src-list"]),p("div",null,[e(c,{type:"danger",size:"small",onClick:t[7]||(t[7]=a=>o.imageUrl=""),style:{"margin-top":"5px"}},{default:l(()=>t[27]||(t[27]=[r("删除图片")])),_:1})])])):R("",!0)]),_:1}),e(v,{label:"关键词",prop:"keywords"},{default:l(()=>[e(u,{modelValue:o.keywords,"onUpdate:modelValue":t[8]||(t[8]=a=>o.keywords=a),placeholder:"请输入关键词，多个关键词用逗号分隔"},null,8,["modelValue"])]),_:1}),e(v,{label:"选题描述",prop:"description"},{default:l(()=>[e(u,{modelValue:o.description,"onUpdate:modelValue":t[9]||(t[9]=a=>o.description=a),type:"textarea",rows:3,placeholder:"请输入选题描述"},null,8,["modelValue"])]),_:1}),e(v,{label:"项目背景",prop:"background"},{default:l(()=>[e(u,{modelValue:o.background,"onUpdate:modelValue":t[10]||(t[10]=a=>o.background=a),type:"textarea",rows:4,placeholder:"请输入项目背景"},null,8,["modelValue"])]),_:1}),e(v,{label:"项目目标",prop:"objectives"},{default:l(()=>[e(u,{modelValue:o.objectives,"onUpdate:modelValue":t[11]||(t[11]=a=>o.objectives=a),type:"textarea",rows:4,placeholder:"请输入项目目标"},null,8,["modelValue"])]),_:1}),e(v,{label:"研究方法",prop:"methodology"},{default:l(()=>[e(u,{modelValue:o.methodology,"onUpdate:modelValue":t[12]||(t[12]=a=>o.methodology=a),type:"textarea",rows:4,placeholder:"请输入研究方法"},null,8,["modelValue"])]),_:1}),e(v,{label:"预期成果",prop:"expectedResults"},{default:l(()=>[e(u,{modelValue:o.expectedResults,"onUpdate:modelValue":t[13]||(t[13]=a=>o.expectedResults=a),type:"textarea",rows:4,placeholder:"请输入预期成果"},null,8,["modelValue"])]),_:1}),e(v,{label:"状态",prop:"status"},{default:l(()=>[e(C,{modelValue:o.status,"onUpdate:modelValue":t[14]||(t[14]=a=>o.status=a),placeholder:"请选择状态",style:{width:"100%"}},{default:l(()=>[e(n,{label:"待评价",value:"待评价"}),e(n,{label:"评价中",value:"评价中"}),e(n,{label:"审核中",value:"审核中"}),e(n,{label:"审核通过",value:"审核通过"}),e(n,{label:"审核不通过",value:"审核不通过"})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"]),e(P,{modelValue:U.value,"onUpdate:modelValue":t[18]||(t[18]=a=>U.value=a),title:"选题详情",width:"70%"},{footer:l(()=>[p("span",Le,[e(c,{onClick:t[17]||(t[17]=a=>U.value=!1)},{default:l(()=>t[30]||(t[30]=[r("关闭")])),_:1})])]),default:l(()=>[d.value?(w(),h("div",Ie,[e(M,{gutter:20},{default:l(()=>[e(z,{span:16},{default:l(()=>[e(O,{column:2,border:""},{default:l(()=>[e(g,{label:"选题名称",span:2},{default:l(()=>[r(m(d.value.title),1)]),_:1}),e(g,{label:"分类"},{default:l(()=>[e(E,null,{default:l(()=>[r(m(d.value.category),1)]),_:1})]),_:1}),e(g,{label:"状态"},{default:l(()=>[e(E,{type:F(d.value.status)},{default:l(()=>[r(m(d.value.status),1)]),_:1},8,["type"])]),_:1}),e(g,{label:"关键词",span:2},{default:l(()=>[r(m(d.value.keywords),1)]),_:1}),e(g,{label:"提交时间",span:2},{default:l(()=>[r(m(d.value.submitTime),1)]),_:1}),e(g,{label:"更新时间",span:2},{default:l(()=>[r(m(d.value.updateTime),1)]),_:1})]),_:1})]),_:1}),d.value.imageUrl?(w(),H(z,{key:0,span:8},{default:l(()=>[p("div",Ne,[e(j,{src:d.value.imageUrl,style:{width:"200px",height:"150px","border-radius":"8px",border:"1px solid #dcdfe6"},fit:"cover","preview-src-list":[d.value.imageUrl]},null,8,["src","preview-src-list"])])]),_:1})):R("",!0)]),_:1}),p("div",$e,[e(O,{column:1,border:""},{default:l(()=>[e(g,{label:"选题描述"},{default:l(()=>[p("div",Fe,m(d.value.description),1)]),_:1}),e(g,{label:"项目背景"},{default:l(()=>[p("div",Me,m(d.value.background),1)]),_:1}),e(g,{label:"项目目标"},{default:l(()=>[p("div",Pe,m(d.value.objectives),1)]),_:1}),e(g,{label:"研究方法"},{default:l(()=>[p("div",Oe,m(d.value.methodology),1)]),_:1}),e(g,{label:"预期成果"},{default:l(()=>[p("div",qe,m(d.value.expectedResults),1)]),_:1})]),_:1})])])):R("",!0)]),_:1},8,["modelValue"])])}}},mt=de(Ae,[["__scopeId","data-v-fb77f4a7"]]);export{mt as default};
