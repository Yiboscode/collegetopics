/* empty css                *//* empty css               *//* empty css                *//* empty css                  *//* empty css                   *//* empty css            *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                *//* empty css               *//* empty css              */import{r as p}from"./request-CfAbx4ue.js";/* empty css                    */import{O as T,r as U,c as _,a as c,n as b,b as l,z as A,w as a,A as D,B as L,C as I,D as J,E as s,o as f,j as u,G as O,m as R,u as P,J as $,K as F,L as H,N as y}from"./index-BlySnbrc.js";const M={class:"card",style:{"margin-bottom":"5px"}},j={class:"card",style:{"margin-bottom":"5px"}},G={class:"card",style:{"margin-bottom":"5px"}},K={key:0,class:"card"},Q={style:{padding:"20px"}},W={class:"dialog-footer"},ge={__name:"Qa",setup(X){const g=T(),e=U({user:JSON.parse(localStorage.getItem("xm-user")||"{}"),tableData:[],total:0,pageNum:1,pageSize:5,form:{},ids:[],userName:null,rules:{answer:[{required:!0,message:"请输入回复",trigger:"blur"}]},teacherList:[],userList:[]}),h=o=>{e.form=JSON.parse(JSON.stringify(o)),e.formVisible=!0};(()=>{p.get("/teacher/selectAll").then(o=>{o.code==="200"?e.teacherList=o.data:s.error(o.msg)})})(),(()=>{p.get("/user/selectAll").then(o=>{o.code==="200"?e.userList=o.data:s.error(o.msg)})})();const i=()=>{p.get("/qa/selectPage",{params:{pageNum:e.pageNum,pageSize:e.pageSize,userName:e.userName,teacherId:e.user.role==="TEACHER"?e.user.id:null}}).then(o=>{var t,n;e.tableData=((t=o.data)==null?void 0:t.list)||[],e.total=(n=o.data)==null?void 0:n.total})},w=()=>{p.put("/qa/update",e.form).then(o=>{o.code==="200"?(e.formVisible=!1,s.success("操作成功"),i()):s.error(o.msg)})},N=o=>{y.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(t=>{p.delete("/qa/delete/"+o).then(n=>{n.code==="200"?(s.success("删除成功"),i()):s.error(n.msg)})}).catch(t=>{console.error(t)})},k=o=>{e.ids=o.map(t=>t.id)},x=()=>{if(!e.ids.length){s.warning("请选择数据");return}y.confirm("删除后数据无法恢复，您确定删除吗?","删除确认",{type:"warning"}).then(o=>{p.delete("/qa/delete/batch",{data:e.ids}).then(t=>{t.code==="200"?(s.success("操作成功"),i()):s.error(t.msg)})}).catch(o=>console.log(o))},C=()=>{g.value.validate(o=>{o&&w()})},V=()=>{e.userName=null,i()};return i(),(o,t)=>{const n=A,d=D,m=O,v=L,E=I,S=H,z=F,B=J;return f(),_("div",null,[c("div",M,[l(n,{modelValue:e.userName,"onUpdate:modelValue":t[0]||(t[0]=r=>e.userName=r),placeholder:"请输入用户查询",style:{width:"240px"}},null,8,["modelValue"]),l(d,{type:"info",plain:"",style:{"margin-left":"10px"},onClick:i},{default:a(()=>t[5]||(t[5]=[u("查询")])),_:1}),l(d,{type:"warning",plain:"",style:{"margin-left":"10px"},onClick:V},{default:a(()=>t[6]||(t[6]=[u("重置")])),_:1})]),c("div",j,[l(d,{type:"danger",plain:"",onClick:x},{default:a(()=>t[7]||(t[7]=[u("批量删除")])),_:1})]),c("div",G,[l(v,{data:e.tableData,stripe:"",onSelectionChange:k,"tooltip-effect":"dark dark1"},{default:a(()=>[l(m,{type:"selection",width:"55"}),l(m,{prop:"userName",label:"用户名称",width:"100"}),l(m,{prop:"question",label:"问题","show-overflow-tooltip":""}),l(m,{prop:"teacherName",label:"教师名称",width:"100"}),l(m,{prop:"answer",label:"回复","show-overflow-tooltip":""}),l(m,{prop:"time",label:"时间"}),l(m,{label:"操作",width:"120",fixed:"right"},{default:a(r=>[e.user.role==="TEACHER"?(f(),R(d,{key:0,type:"primary",size:"small",onClick:q=>h(r.row)},{default:a(()=>t[8]||(t[8]=[u("回复")])),_:2},1032,["onClick"])):b("",!0),l(d,{type:"danger",circle:"",icon:P($),onClick:q=>N(r.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),e.total?(f(),_("div",K,[l(E,{onCurrentChange:i,background:"",layout:"total, prev, pager, next","page-size":e.pageSize,"current-page":e.pageNum,"onUpdate:currentPage":t[1]||(t[1]=r=>e.pageNum=r),total:e.total},null,8,["page-size","current-page","total"])])):b("",!0),l(B,{title:"项目问答回复",style:{padding:"20px","min-height":"200px"},modelValue:e.formVisible,"onUpdate:modelValue":t[4]||(t[4]=r=>e.formVisible=r),width:"50%","close-on-click-modal":!1,"destroy-on-close":""},{footer:a(()=>[c("span",W,[l(d,{onClick:t[3]||(t[3]=r=>e.formVisible=!1)},{default:a(()=>t[9]||(t[9]=[u("取消")])),_:1}),l(d,{type:"primary",onClick:C},{default:a(()=>t[10]||(t[10]=[u("保存")])),_:1})])]),default:a(()=>[c("div",Q,[l(z,{ref_key:"formRef",ref:g,model:e.form,rules:e.rules,"label-width":"80px"},{default:a(()=>[l(S,{label:"回复",prop:"answer"},{default:a(()=>[l(n,{type:"textarea",rows:"4",modelValue:e.form.answer,"onUpdate:modelValue":t[2]||(t[2]=r=>e.form.answer=r),placeholder:"请输入回复内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])])}}};export{ge as default};
